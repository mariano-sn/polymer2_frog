<link rel="import" href="../../bower_components/polymer/polymer-element.html">
<link rel="import" href="../../bower_components/noto-emoji-iconset/noto-emoji-iconset.html">
<link rel="import" href="../../bower_components/noto-emoji-iconset/emoji-icon.html">

<dom-module id="frog-list">
  <template>
    <style>
      :host {
        display: block;
        background-color: black;
      }
      /**
      * Estilo aplicado a todas a las etiquetas con id = "btnJump"
      */
      #btnJump{
        display: inline-block;
        padding: 0em 1.5em;
        width: 1250px;
        height: auto;
      }
      /**
      * Estilo aplicado a todas a las etiquetas div dentro de un id = "btnJump"
      */
      #btnJump > div{
        display: inline-block;
        width: 100px;
        margin: 0px 5px;
        align-content: center;
      }
      /**
      * Estilo aplicado a todas a las etiquetas emoji-icon dentro
      * de una etiqueta p contenida dentro de un div y este dentro de un id = "btnJump"
      */
      #btnJump > div p emoji-icon{
        --emoji-icon-width: 40px;
        --emoji-icon-height: 40px;
      }
      /**
      * Estilo aplicado a todas a las etiquetas con id = "wayFrog"
      */
      #wayFrog{
        padding: 1.5em 1.5em;
        justify-content: center;
        width: 1320px;
        height: auto;
      }
      /**
      * Estilo aplicado a todas a las etiquetas div dentro de un id = "wayFrog"
      */
      #wayFrog > div{
        padding: 5px 5px;
        display: inline-block;
        background-color: black;
      }
      /**
      * Estilo aplicado a todas a las etiquetas p dentro de un
      * div contenido dentro de una etiqueta con id = "wayFrog"
      */
      #wayFrog > div p{
        width: 110px;
        height: 110px;
        border: 1px solid darkcyan;
        border-radius: 10px;
        margin: 0px 0px;
      }
      /**
      * Estilo aplicado a todas a las etiquetas emoji-icon dentro
      * de una etiqueta p contenida dentro de un div y este dentro de un id = "wayFrog"
      */
      #wayFrog > div p emoji-icon{
        --emoji-icon-width: 80px;
        --emoji-icon-height: 80px;
      }
      /**
      * Estilo aplicado a todas a las etiquetas button
      */
      button{
        border-radius: 10px;
        width: 100px;
        height: 40px;
      }
      /**
      * Estilo aplicado a todas a las etiquetas button seleccionadas
      */
      button:hover{
        background-color: lightseagreen;
      }
      /**
      * Estilo aplicado a todas a las etiquetas p dentro de un div
      */
      div > p{
        color: white;
        text-align: center;
        margin: 5px 0px;
      }
      /**
      * Estilo aplicado a todas a las etiquetas con id = "pMvs"
      */
      #pMvs{
        color: white;
        padding: 0em 1.5em;
        width: 90%;
        height: auto;
      }
    </style>
    <!--Inicio de sección de control de movimientos-->
    <p id="pMvs">Movimientos</p>
    <div id="btnJump">
      <div>
        <button on-click="_setJumpFirst">
          <emoji-icon emoji="[[selection]]"></emoji-icon>   
          <emoji-icon emoji=":track_previous:"></emoji-icon>
        </button>
        <p>Inicio</p>
      </div>
      <div>
        <button on-click="_setJumpLeft">
          <emoji-icon emoji="[[selection]]"></emoji-icon>   
          <emoji-icon emoji=":rewind:"></emoji-icon>
        </button>
        <p>Atras</p>
      </div>
      <div>
          <button on-click="_setJumpBack">
            <emoji-icon emoji="[[selection]]"></emoji-icon>   
            <emoji-icon emoji=":arrow_backward:"></emoji-icon>
          </button>
          <p>Anterior</p>
        </div>
      <div>
        <button on-click="_setReset">
          <emoji-icon emoji="[[selection]]"></emoji-icon>   
          <emoji-icon emoji=":repeat:"></emoji-icon>
        </button>
        <p>Reset</p>
      </div>
      <div>
        <button on-click="_setJumpNext">
          <emoji-icon emoji="[[selection]]"></emoji-icon>   
          <emoji-icon emoji=":arrow_forward:"></emoji-icon>
        </button>
        <p>Siguiente</p>
      </div>
      <div>
        <button on-click="_setJumpRight">
          <emoji-icon emoji="[[selection]]"></emoji-icon>   
          <emoji-icon emoji=":fast_forward:"></emoji-icon>
        </button>
        <p>Adelante</p>
      </div>
      <div>
        <button on-click="_setJumpLast">
          <emoji-icon emoji="[[selection]]"></emoji-icon>   
          <emoji-icon emoji=":track_next:"></emoji-icon>
        </button>
        <p>Fin</p>
      </div>
      <div>
        <p>
          <template is="dom-repeat" items="[[jumps]]" as="jump" mutable-data>
            <emoji-icon emoji="[[jump]]"></emoji-icon>
          </template>
        </p>
        <p>Saltos</p>
      </div>
      <div>
        <p>
          <template is="dom-repeat" items="[[emojiPosition]]" as="emojiPos" mutable-data>
            <emoji-icon emoji="[[emojiPos]]"></emoji-icon>
          </template>
        <p>Posición</p>
      </div>
      <div style="width: 200px;">
        <p>
          <template is="dom-repeat" items="[[listmoves]]" as="mov" mutable-data>
            <emoji-icon emoji="[[mov]]"></emoji-icon>
          </template>
        <p>Movimientos</p>
      </div>
    </div>
    <!--Fin de sección de control de movimientos-->
    <!--Inicio de sección de casillas-->
    <div id="wayFrog"></div>
    <!--Fin de sección de casillas-->
  </template>
  <script>
    /**
     * @customElement
     * @polymer
     */
    class FrogList extends Polymer.Element {
      /**
       * Get de función is
       * @return {String} Nombre de dom-module id
       */
      static get is() { 
        return 'frog-list'; 
      }
      /**
       * Función de observers para detectar modificaciones en un Array
       * se utiliza el comodín * para detectar los cambios
       */
      static get observers() {
        return [
          '_setListFrog(arreglo.*)'
        ];
      }
      /**
       * Objeto properties que incluye las propiedades a utilizar
       */
      static get properties() {
        return {
          /**
           * Arreglo de casillas 
           */
          arreglo:{
            type: Array,
            value: function (){
              return [true,false,false,false,false,false,false,false,false,false];
            }
          },
          /**
           * Selección de imágen lanzando función _setListFrog en cada
           * modificación de la variable
           */
          selection:{
            type: String,
            value: '',
            observer: '_setListFrog'
          },
          /**
           * Arreglo de saltos dados para pintar los emoji-icon
           */
          jumps:{
            type: Array,
            value: function(){
              return ['zero','zero'];
            }
          },
          /**
           * Arreglo de la posición donde se encuentra la rana para pintar los emoji-icon
           */
          listmoves:{
            type: Array,
            value: function(){
              return ['zero','zero','zero','zero'];
            }
          },
          /**
           * Posición actual de la rana
           */
          position:{
            type: Number,
            value: 0
          },
          /**
           * Movimientos actuales de la rana
           */
          moves:{
            type: Number,
            value: 0
          },
          /**
           * Número de casillas seleccionada lanza función _setReset en caso
           * de que se modifique el valor de la propiedad
           */
          casillas:{
            type: Number,
            observer: '_setReset'
          },
          /**
           * Color del borde de las casillas lanza la función _setListFrog
           * en caso de que se modifique el valor de la propiedad
           */
          bordercolor:{
            type: String,
            observer: '_setListFrog'
          },
          /**
           * Color de fondo del borde de las casillas lanza la función _setListFrog
           * en caso de que se modifique el valor de la propiedad
           */
          fondocolor:{
            type: String,
            observer: '_setListFrog'
          },
          /**
           * Radio del borde de las casillas lanza la función _setListFrog
           * en caso de que se modifique el valor de la propiedad
           */
          radius:{
            type: String,
            observer: '_setListFrog'
          },
          /**
           * Sombra de las casillas lanza la función _setListFrog
           * en caso de que se modifique el valor de la propiedad
           */
          shadow:{
            type: String,
            observer: '_setListFrog'
          },
          /**
           * Tamaño de icono del contenido de las casillas lanza la función _setListFrog
           * en caso de que se modifique el valor de la propiedad
           */
          iconosize:{
            type: String,
            observer: '_setListFrog'
          },
          /**
           * Padding de las casillas lanza la función _setListFrog
           * en caso de que se modifique el valor de la propiedad
           */
          iconopadding:{
            type: String,
            observer: '_setListFrog'
          },
          /**
           * Etilo de línea del borde de las casillas lanza la función _setListFrog
           * en caso de que se modifique el valor de la propiedad
           */
          styleline:{
            type: String,
            observer: '_setListFrog'
          },
          /**
           * Grosor de línea del borde de las casillas lanza la función _setListFrog
           * en caso de que se modifique el valor de la propiedad
           */
          grosorline:{
            type: String,
            observer: '_setListFrog'
          },
          /**
           * Velocidad de animación de salto lanza la función _setListFrog
           * en caso de que se modifique el valor de la propiedad
           */
          speed:{
            type: String
          },
          /**
           * Vacio de las casillas lanza la función _setListFrog
           * en caso de que se modifique el valor de la propiedad
           */
          empty:{
            type: String,
            observer: '_setListFrog'
          },
          /**
           * Icono en las casillas vacias lanza la función _setListFrog
           * en caso de que se modifique el valor de la propiedad
           */
          emptyicon:{
            type: String,
            observer: '_setListFrog'
          },
          /**
           * Arreglo del icono a pintar de la posición actual de la rana
           */
          emojiPosition:{
            type: Array,
            value: function(){
              return ['zero','zero'];
            }
          }
        };
      }
      /**
       * Función para realizar un reset de los movimientos
       */
      _setReset(){
        this.position = 0;
        this.moves = 0;
        this._setNumJump(this.position);
        this._setNumPos(this.position);
        this._setNumMov(this.moves);
        this._setNumCasillas();
      }
      /**
       * Función para generar un random entero en un intervalo
       * @return {Number} Número randon entero generado
       */
      _getRandomNumber(){
        var rand = Math.floor(Math.random()*(this.arreglo.length)+1);
        return rand;
      }
      /**
       * Set de número de casillas seleccionadas
       */
      _setNumCasillas(){
        var newArreglo = [];
        for(let i=0;i<this.casillas;i++){
          if(i==0){
            newArreglo.push(true);
          }else{
            newArreglo.push(false);
          }
        }
        this.set('arreglo',newArreglo);
      }
      /**
       * Salto a la derecha de forma aleatoria
       */
      _setJumpRight(){
        let numJump = this._getRandomNumber();
        this._setNumJump(numJump);
        let pos = this.position;
        let ant;
        for(let i=0;i<numJump;i++){
          setTimeout(()=>{
            pos += 1;
            if(pos == this.arreglo.length){
              pos = 0;
              ant = this.arreglo.length - 1;
            }else{
              ant = (pos-1);
            }
            this.set('arreglo.'+ant,false);
            this.set('arreglo.'+pos,true);
            this.position = pos;
            this.moves += 1;
            this._setNumMov(this.moves);
            this._setNumPos(this.position);
          },parseInt(this.speed)*i);
        }
      }
      /**
       * Un salto a la derecha
       */
      _setJumpNext(){
        let pos = this.position;
        let numJump = 1;
        this._setNumJump(numJump);
        let ant;
        setTimeout(()=>{
          pos += 1;
          if(pos == this.arreglo.length){
            pos = 0;
            ant = this.arreglo.length - 1;
          }else{
            ant = (pos-1);
          }
          this.set('arreglo.'+ant,false);
          this.set('arreglo.'+pos,true);
          this.position = pos;
          this.moves += 1;
          this._setNumMov(this.moves);
          this._setNumPos(this.position);
        },100);
      }
      /**
       * Saltos hasta el final de las casillas
       */
      _setJumpLast(){
        let pos = this.position;
        let numJump = (this.arreglo.length - 1) - pos;
        this._setNumJump(numJump);
        let ant;
        for(let i=0;i<numJump;i++){
          setTimeout(()=>{
            pos += 1;
            if(pos == this.arreglo.length){
              pos = 0;
              ant = this.arreglo.length - 1;
            }else{
              ant = (pos-1);
            }
            this.set('arreglo.'+ant,false);
            this.set('arreglo.'+pos,true);
            this.position = pos;
            this.moves += 1;
            this._setNumMov(this.moves);
            this._setNumPos(this.position);
          },parseInt(this.speed)*i);
        }
      }
      /**
       * Un salta a la izquierda
       */
      _setJumpBack(){
        let pos = this.position;
        let numJump = 1;
        this._setNumJump(numJump);
        let ant;
        setTimeout(()=>{
          pos -= 1;
          if(pos == -1){
            pos = this.arreglo.length - 1;
            ant = 0;
          }else{
            ant = (pos+1);
          }
          this.set('arreglo.'+ant,false);
          this.set('arreglo.'+pos,true);
          this.position = pos;
          this.moves += 1;
          this._setNumMov(this.moves);
          this._setNumPos(this.position);
        },100);
      }
      /**
       * Saltos a las izquierda de forma aleatoria
       */
      _setJumpLeft(){
        let numJump = this._getRandomNumber();
        this._setNumJump(numJump);
        let pos = this.position;
        let ant;
        for(let i=0;i<numJump;i++){
          setTimeout(()=>{
            pos -= 1;
            if(pos == -1){
              pos = this.arreglo.length - 1;
              ant = 0;
            }else{
              ant = (pos+1);
            }
            this.set('arreglo.'+ant,false);
            this.set('arreglo.'+pos,true);
            this.position = pos;
            this.moves += 1;
            this._setNumMov(this.moves);
            this._setNumPos(this.position);
          },parseInt(this.speed)*i);
        }
      }
      /**
       * Función de salto al inicio
       */
      _setJumpFirst(){
        let pos = this.position;
        let numJump = pos;
        this._setNumJump(numJump);
        let ant;
        for(let i=0;i<numJump;i++){
          setTimeout(()=>{
            pos -= 1;
            if(pos == -1){
              pos = this.arreglo.length - 1;
              ant = 0;
            }else{
              ant = (pos+1);
            }
            this.set('arreglo.'+ant,false);
            this.set('arreglo.'+pos,true);
            this.position = pos;
            this.moves += 1;
            this._setNumMov(this.moves);
            this._setNumPos(this.position);
          },parseInt(this.speed)*i);
        }
      }
      /**
       * Get del emoji-icon para pintar números de datos o posiciones
       * @param {Number} num Número que se desea saber el emoji-icon asociado
       * @return {String} valor del emoji-icon
       */
      _getNumEmoji(num){
        if(parseInt(num) == 0){
          return 'zero';
        }else if(parseInt(num) == 1){
          return 'one';
        }else if(parseInt(num) == 2){
          return 'two';
        }else if(parseInt(num) == 3){
          return 'three';
        }else if(parseInt(num) == 4){
          return 'four';
        }else if(parseInt(num) == 5){
          return 'five';
        }else if(parseInt(num) == 6){
          return 'six';
        }else if(parseInt(num) == 7){
          return 'seven';
        }else if(parseInt(num) == 8){
          return 'eight';
        }else if(parseInt(num) == 9){
          return 'nine';
        }
      }
      /**
       * Obtiene el emoji que se debe de obtener del número de saltos
       * @param {Number} num Número que se quiere pintar de saltos
       */
      _setNumJump(num){
        var numS = num.toString();
        if(num >= 10){
          this.set('jumps.0',this._getNumEmoji(numS.charAt(0)));
          this.set('jumps.1',this._getNumEmoji(numS.charAt(1)));
        }else{
          this.set('jumps.0',this._getNumEmoji('0'));
          this.set('jumps.1',this._getNumEmoji(numS.charAt(0)));
        }
      }
      /**
       * Obtiene el emoji que se debe de obtener del número de posición
       * @param {Number} num Número que se quiere pintar de posición
       */
      _setNumPos(num){
        var numP = num.toString();
        if(num >= 10){
          this.set('emojiPosition.0',this._getNumEmoji(numP.charAt(0)));
          this.set('emojiPosition.1',this._getNumEmoji(numP.charAt(1)));
         }else{
          this.set('emojiPosition.0',this._getNumEmoji('0'));
          this.set('emojiPosition.1',this._getNumEmoji(numP.charAt(0)));
        }
      }
      /**
       * Obtiene el emoji que se debe de obtener del número de movimientos
       * @param {Number} num Número que se quiere pintar de movimientos
       */
       _setNumMov(num){
        var numM = num.toString();
        if(num == 9999){
          this.moves = 0;
          numM = '0';
        }
        if(num >= 1000){
          this.set('listmoves.0',this._getNumEmoji(numM.charAt(0)));
          this.set('listmoves.1',this._getNumEmoji(numM.charAt(1)));
          this.set('listmoves.2',this._getNumEmoji(numM.charAt(2)));
          this.set('listmoves.3',this._getNumEmoji(numM.charAt(3)));
         }else if(num >= 100 && num < 1000){
          this.set('listmoves.0',this._getNumEmoji('0'));
          this.set('listmoves.1',this._getNumEmoji(numM.charAt(0)));
          this.set('listmoves.2',this._getNumEmoji(numM.charAt(1)));
          this.set('listmoves.3',this._getNumEmoji(numM.charAt(2)));
        }else if(num >= 10 && num < 100){
          this.set('listmoves.0',this._getNumEmoji('0'));
          this.set('listmoves.1',this._getNumEmoji('0'));
          this.set('listmoves.2',this._getNumEmoji(numM.charAt(0)));
          this.set('listmoves.3',this._getNumEmoji(numM.charAt(1)));
        }else{
          this.set('listmoves.0',this._getNumEmoji('0'));
          this.set('listmoves.1',this._getNumEmoji('0'));
          this.set('listmoves.2',this._getNumEmoji('0'));
          this.set('listmoves.3',this._getNumEmoji(numM.charAt(0)));
        }
      }
      /**
       * Pintado de las casillas en div wayFrog
       */
      _setListFrog(){
        var padre = this.$.wayFrog;
        //Limpiamos el contenido del div para evitar duplicidades
        padre.innerHTML = "";
        for(let i=0;i<this.arreglo.length;i++){
          let child = document.createElement("div");
          let p = document.createElement("p");
          p.style.border = this.grosorline;
          p.style.borderStyle = this.styleline;
          p.style.borderColor = this.bordercolor;
          p.style.backgroundColor = this.fondocolor;
          if(this.shadow == 'Si'){
            p.style.boxShadow = "4px 4px 7px lightgrey";
          }else if(this.shadow == 'No'){
            p.style.boxShadow = "";
          }
          p.style.borderRadius = this.radius;
          let frog = document.createElement("emoji-icon");
          frog.setAttribute("emoji",this._setFrog(this.get(['arreglo',i])));
          frog.setAttribute("style",this.iconosize);
          frog.style.padding = this.iconopadding;
          p.appendChild(frog);
          child.appendChild(p);
          padre.appendChild(child);
        }
      }
      /**
       * Función que nos devuelve la clase a aplicar en el div
       * dependiendo de un boolean
       */
      _setFrog(marca){
        if(marca){
          return this.selection;
        }else{
          if(this.empty == 'false'){
            return '';
          }else{
            return this.emptyicon;
          }
        }
      }
      /**
       * Constructor
       */
      constructor(){
        super();
      }
    }
    window.customElements.define(FrogList.is, FrogList);
  </script>
</dom-module>